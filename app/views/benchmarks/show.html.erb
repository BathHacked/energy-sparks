<% content_for :page_title, @title %>

<p class="pt-4"><%= link_to 'All benchmarks on a single page', all_benchmarks_path %></p>
<p><%= link_to 'List of benchmarks', benchmarks_path %></p>
<p><%= link_to 'Download benchmark results YAML file', benchmark_path({format: :yaml}) %></p>



<p>
  <a class="btn btn-primary" data-toggle="collapse" href="#benchmarkErrors" role="button" aria-expanded="false" aria-controls="benchmarkErrors">
    See errors from the benchmark content framework when generating content
  </a>
</p>
<div class="collapse" id="benchmarkErrors">
  <% if can?(:read, :benchmark_errors_messages) %>
    <% @errors.each do |error| %>
     <div class="card card-body">
      <h4><%= error[:message] %></h4>
      <p class="very-small"><%= sanitize error[:full_html_output] %></p>
        </div>
    <% end %>
  <% end %>
</div>

<%= form_tag @form_path, method: :get do %>
  <h2>Filters</h2>
  <%= hidden_field_tag :benchmark_type, @page if @page %>
  <fieldset class="form-group">
    <legend>School Groups</legend>
    <%= collection_check_boxes :benchmark, :school_group_ids, @school_groups, :id, :name, { multiple: true } do |b| %>
      <div class="custom-control custom-checkbox">

        <%= b.check_box( checked: @school_group_ids.include?(b.object.id.to_s), class: "custom-control-input") %>
        <%= b.label(class: "custom-control-label") do %>
          <%= b.object.name %>
        <% end %>
      </div>
    <% end %>
  </fieldset>

  <%= submit_tag "Filter Benchmarks", class: 'btn btn-info' %>
<% end %>

<% @page_groups.each do |page_group| %>
  <h2><%= page_group[:name] %></h2>
  <% page_group[:benchmarks].each do |benchmark, _title| %>
    <% @content_hash[benchmark].each do |content| %>
      <%= render content[:type].to_s, content: content[:content], school: @school %>
    <% end %>
  <% end %>
<% end %>
