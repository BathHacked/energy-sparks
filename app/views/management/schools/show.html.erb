<%= content_for :page_title, "Management dashboard for #{@school.name}" %>

<div class="d-flex justify-content-between align-items-center">
  <h1>Energy Usage&hellip;</h1>
  <% if @school.configuration %>
    <div class="h5"><%= link_to "Review your school's energy analysis", school_analysis_index_path(@school), class: 'btn btn-outline-dark rounded-pill font-weight-bold' %></div>
  <% end %>
</div>

<h2>Annual use</h2>

<% if @overview_table %>
  <div class="table-responsive-sm">
    <table class="table mb-5 management-overview">
      <thead>
        <tr>
          <% table_headers_from_array(@overview_table.table).each do |column, html_class| %>
            <th class="<%= html_class %>"><%= column %></th>
          <% end  %>
        </tr>
      </thead>
      <tbody>
        <% table_body_from_array(@overview_table.table).each do |row| %>
          <tr>
            <% table_row_from_array(row).each do |column, html_class| %>
              <td class="<%= html_class %>"><%= up_downify(column) %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>

<% unless @overview_charts.empty? %>
  <%= render 'overview_charts', overview_charts: @overview_charts %>
<% end %>

<% if @add_contacts %>
  <%= render 'shared/add_contacts', school: @school %>
<% end %>

<% if @add_pupils %>
  <%= render 'shared/add_pupils', school: @school %>
<% end %>

<% unless @management_priorities.empty? %>
  <%= render 'management/management_priorities/list', management_priorities: @management_priorities, school: @school, show_more: @show_more_management_priorities %>
<% end %>

<h2>Recent use</h2>

<div class="row dashboards">
  <%= render 'shared/dashboard_energy_charts', charts: @charts, school: @school %>
</div>

<%= render 'shared/dashboard_alerts', dashboard_alerts: @dashboard_alerts, school: @school, content_field: :management_dashboard_title, title: 'Recent energy use alerts'%>

<%= render 'shared/dashboard_timeline', school: @school, observations: @observations %>

<div class="row padded-row management-energy-saving-actions d-flex justify-content-center mb-3">
  <%= link_to 'Record an energy saving action', new_school_action_path(@school), class: 'btn btn-rounded' %>
</div>
