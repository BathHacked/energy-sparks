<% content_for :page_title do %>
Schools
<% end %>

<section id="enrolled">
  <div class="row padded-row">
    <div class="col-md-8">
      <h1>Participating Schools</h1>
    </div>
    <div class="col-md-4">
      <div class='btn-group float-right'>
        <%= link_to 'Scoreboards', scoreboards_path, class: 'btn' %>
      </div>
    </div>
    <div class="col-md-12">
      <p>These schools are using <%= t('application') %> to reduce their energy usage. See their usage data, compare scores and learn about their energy saving activities</p>
      <p>You can also <%= link_to 'compare schools', benchmarks_path %></p>
    </div>
  </div>

  <ul class="nav nav-pills">
    <li class="nav-item">
      <a class="nav-link disabled" href="#">Jump to</a>
    </li>
    <% @school_groups.each do |school_group| %>
      <li class="nav-item">
        <%= link_to "#{school_group.name}", "##{school_group.name.parameterize}", class: 'nav-link' %>
      </li>
    <% end %>
  </ul>

  <% @school_groups.each do |school_group| %>
    <%= render 'schools/list', name: school_group.name, scoreboard: nil, schools: school_group.schools.visible.order(:name), benchmark_filter: {school_group_ids: [school_group.id]}%>
  <% end %>

  <% if @ungrouped_visible_schools.any? %>
    <div class="row padded-row">
      <div class="col-lg-12">
        <h3>Other schools</h3>
      </div>
    </div>
    <% @ungrouped_visible_schools.each_slice(3) do |row| %>
      <div class="row school-card-row">
        <div class="col-lg-12">
          <div class="card-deck">
            <% row.each do |school| %>
              <%= render partial: 'schools/school_card', locals: {school: school} %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>

</section>

<section id="eligible">
  <div class="container">
    <div class="row padded-row">
      <div class="col-lg-12">
        <% if can?(:read_invisible_schools, School) %>
          <h3>Not visible schools</h3>
          <p>The following schools are not visible.</p>
          <div class="card-columns">
            <% @schools_not_visible.each do |school| %>
              <%= render partial: 'schools/school_card', locals: {school: school} %>
            <% end %>
        <% else %>
          <p>If your school has not been enrolled, but you would like to find out more, you can find out <%= link_to "how to get involved", enrol_path %>.</p>
        <% end %>
      </div>
    </div>
  </div>
</section>

<% if can? :manage, School -%>
  <%= link_to 'Manual School Setup', new_school_path, class: 'btn btn-primary' %>
  <%= link_to "Automatic School Setup", admin_school_onboardings_path, class: 'btn btn-primary' %>
<% end %>

