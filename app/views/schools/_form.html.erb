<%= form_for(school) do |f| %>

  <%= render 'shared/errors', subject: school, subject_name: 'school' %>

  <% if school.persisted? %>
    <% if school.active? %>
      <% if can? :deactivate, school %>
        <div class="alert alert-warning">
          <%= school.name %> is currently <strong>ACTIVE</strong>.
          <% if can? :deactivate, @school %>
            <%= link_to "Deactivate school", school_deactivation_path(school), method: :post, class: 'btn btn-danger ml-3' %>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <div class="alert alert-warning">
        <%= school.name %> is currently <strong>INACTIVE</strong> and won't be accessible to non-admin users.
        <% if can? :activate, school %>
          <%= link_to "Activate school", school_activation_path(school), method: :post, class: 'btn btn-success ml-3' %>
        <% end %>
      </div>
    <% end %>
  <% end %>

  <div class="form-group">
    <%= f.label :name %>
    <%= f.text_field :name, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :urn, 'Unique Reference Number (URN)' %>
    <%= f.number_field :urn, class: 'form-control' %>
  </div>

  <h2>School Type</h2>
  <div class="form-group">
    <% School.school_types.keys.each do |school_type| %>
      <div class="form-check form-check-inline">
        <%= f.radio_button :school_type, school_type, class: "form-check-input" %>
        <%= f.label "school_type_#{school_type.to_sym}", school_type.to_sym.capitalize,  class: "form-check-label" %>
      </div>
    <% end %>
  </div>

  <p>Please select which Key Stages this school teaches.</p>
  <%= f.collection_check_boxes(:key_stage_ids, @key_stages, :id, :name) do |b| %>
    <div class="custom-control custom-checkbox custom-control-inline">
      <%= b.check_box(class: "custom-control-input") %>
      <%= b.label(class: "custom-control-label") do %>
        <%= b.object.name %>
      <% end %>
    </div>
  <% end %>
  <hr/>

  <div class="form-row">
    <div class="form-group col-md-6">
      <%= f.label :number_of_pupils %>
      <%= f.number_field :number_of_pupils, class: 'form-control' %>
    </div>
    <div class="form-group col-md-6">
      <%= f.label :floor_area, 'Floor area in square metres' %>
      <%= f.number_field :floor_area, class: 'form-control' %>
    </div>
  </div>

  <h2>Address</h2>
  <div class="form-group">
    <%= f.label :address %>
    <%= f.text_area :address, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :postcode %>
    <%= f.text_field :postcode, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :website %>
    <%= f.text_field :website, class: 'form-control' %>
  </div>

  <div class="actions">
    <%= f.submit submit_text, class: 'btn btn-primary' %>
  </div>
<% end %>
