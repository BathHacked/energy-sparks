<h1>Add tariff rates</h1>

<h2><%= render 'title', type: 'electricity' %> </h2>



<h4>Rates</h4>

<table class="table table-striped table-sm">

  <thead>
  <tr>
    <th>Type</th>
    <th>Rate</th>
    <th style="width: 10%"></th>
  </tr>
  </thead>
  <tbody>
  <tr class="rate-row">
    <td>00:00 to 06:30</td>
    <td>9.573p/kwh</td>
    <td>
      <%= link_to "Edit", '#', class: 'btn btn-info addsection' %>
      <%= link_to "Delete", '#', class: 'btn btn-info removesection' %>
    </td>
  </tr>
  <tr class="rate-row">
    <td>08:00 to 19:30</td>
    <td>23.573p/kwh</td>
    <td>
      <%= link_to "Edit", '#', class: 'btn btn-info addsection' %>
      <%= link_to "Delete", '#', class: 'btn btn-info removesection' %>
    </td>
  </tr>
  <tr class="rate-row">
    <td>20:00 to 23:30</td>
    <td>15.432p/kwh</td>
    <td>
      <%= link_to "Edit", '#', class: 'btn btn-info addsection' %>
      <%= link_to "Delete", '#', class: 'btn btn-info removesection' %>
    </td>
  </tr>
  </tbody>

</table>



<%= render 'rate_modal' %>



<%= link_to "Add another", '#', class: 'btn btn-info addsection' %>

<br/>
<br/>
<br/>
<br/>

<%= form_tag school_tariffs_path, method: :get do %>

  <%= hidden_field_tag :step, 'elec_charges' %>
  <%= render 'hidden_fields' %>

  <%= submit_tag "Next", class: 'btn btn-info' %>

<% end %>


<script>

  $('body').on('click', '.addsection', function() {
    newRate();
  });

  $('body').on('click', '.removesection', function(event) {
    removeRate(event);
  });


  function newRate(event) {
    // var calendarId =  $('#event-modal').data('calendar');
    //
    // $(".event-action").html('New');
    // $('form#event_form').attr('action', '/calendars/' + calendarId + '/calendar_events')
    // $('#event-modal input[name="_method"]').val('post');
    //
    // $("#calendar_event_calendar_event_type_id").val('');
    // $('#event-modal input[name="calendar_event[title]"]').val('');
    //
    // $('#event-modal input[name="calendar_event[start_date]"]').val(event.date.toLocaleDateString("en-GB"));
    // $('#event-modal input[name="calendar_event[end_date]"]').val(event.date.toLocaleDateString("en-GB"));
    //
    // $('#delete_button').hide();

    $('#rate-modal').modal();
  }

  function removeRate(event) {
    // console.log($(this).closest('.rate-row'));
    // $(this).closest('.rate-row').remove();
    $(event.target).closest('.rate-row').remove();
    event.preventDefault();
  }


</script>
